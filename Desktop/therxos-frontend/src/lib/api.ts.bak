const API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3000';

export const analyticsApi = {
  dashboard: async (days: number = 30) => {
    const res = await fetch(`${API_URL}/api/analytics/dashboard?days=${days}`);
    if (!res.ok) throw new Error('Failed to fetch dashboard');
    return res.json();
  },
  byType: async (status: string = 'new') => {
    const res = await fetch(`${API_URL}/api/analytics/by-type?status=${status}`);
    if (!res.ok) throw new Error('Failed to fetch by type');
    return res.json();
  },
  performance: async (days: number = 30) => {
    const res = await fetch(`${API_URL}/api/analytics/performance?days=${days}`);
    if (!res.ok) throw new Error('Failed to fetch performance');
    return res.json();
  },
  topPatients: async (limit: number = 5) => {
    const res = await fetch(`${API_URL}/api/analytics/top-patients?limit=${limit}`);
    if (!res.ok) throw new Error('Failed to fetch top patients');
    return res.json();
  },
};

export const opportunitiesApi = {
  list: async (status?: string) => {
    const url = new URL(`${API_URL}/api/opportunities`);
    if (status) url.searchParams.append('status', status);
    const res = await fetch(url.toString());
    if (!res.ok) throw new Error('Failed to fetch opportunities');
    return res.json();
  },
};
